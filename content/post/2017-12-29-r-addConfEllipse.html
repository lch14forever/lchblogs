---
title: "Add confidence ellipse to LDA ordination plot II"
author: "Chenhao Li (李陈浩)"
date: 2017-12-29
tag: ['R']
output: html_document
---



<section class="level2">
<h2>为排序图添加置信范围曲线</h2>
<p>上一篇<a href="http://lchblogs.netlify.com/post/2017-12-22-r-addconfellipselda/">文章</a>我们利用<a href="https://github.com/fawda123/ggord">ggord</a>的源代码改写了一个为LDA排序图添加置信曲线的函数，现在<a href="https://guangchuangyu.github.io/">Y叔</a>已经把它改写成了一个geom添加在了他的<a href="https://github.com/GuangchuangYu/yyplot">yyplot</a>包中。y叔扩展了它的功能，现在支持ggord中的其他排序图（我没有进行全面的测试）。</p>
<pre class="r"><code>library(ggord)
library(yyplot)
library(MASS)</code></pre>
<section id="lda" class="level3">
<h3>LDA</h3>
<pre class="r"><code>ord &lt;- lda(Species ~ ., iris, prior = rep(1, 3)/3)
ggord(ord, iris$Species) + geom_ord_ellipse(lty=2)</code></pre>
<p><img src="/post/2017-12-29-r-addConfEllipse_files/figure-html/lda-1.png" width="672" /></p>
</section>
<section id="pca" class="level3">
<h3>PCA</h3>
<pre class="r"><code>ord &lt;- prcomp(iris[, 1:4])
ggord(ord, iris$Species) + geom_ord_ellipse(lty=2)</code></pre>
<p><img src="/post/2017-12-29-r-addConfEllipse_files/figure-html/pca-1.png" width="672" /></p>
</section>
<section id="mds" class="level3">
<h3>MDS</h3>
<pre class="r"><code>library(vegan)</code></pre>
<pre><code>## Loading required package: permute</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## This is vegan 2.4-4</code></pre>
<pre class="r"><code>ord &lt;- metaMDS(iris[, 1:4])</code></pre>
<pre><code>## Run 0 stress 0.03775523 
## Run 1 stress 0.05618976 
## Run 2 stress 0.03775616 
## ... Procrustes: rmse 9.46571e-05  max resid 0.0003367565 
## ... Similar to previous best
## Run 3 stress 0.04355828 
## Run 4 stress 0.03775568 
## ... Procrustes: rmse 6.086896e-05  max resid 0.0002174972 
## ... Similar to previous best
## Run 5 stress 0.04355807 
## Run 6 stress 0.0521791 
## Run 7 stress 0.05619533 
## Run 8 stress 0.05093777 
## Run 9 stress 0.03775573 
## ... Procrustes: rmse 6.324561e-05  max resid 0.0002300281 
## ... Similar to previous best
## Run 10 stress 0.05269372 
## Run 11 stress 0.04355838 
## Run 12 stress 0.04713746 
## Run 13 stress 0.04367528 
## Run 14 stress 0.04804044 
## Run 15 stress 0.04367535 
## Run 16 stress 0.05330813 
## Run 17 stress 0.04355821 
## Run 18 stress 0.05537396 
## Run 19 stress 0.05329161 
## Run 20 stress 0.05218155 
## *** Solution reached</code></pre>
<pre class="r"><code>ggord(ord, iris$Species) + geom_ord_ellipse(lty=2)</code></pre>
<p><img src="/post/2017-12-29-r-addConfEllipse_files/figure-html/mds-1.png" width="672" /></p>
</section>
</section>
