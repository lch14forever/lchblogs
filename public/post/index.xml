<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on Chenhao&#39;s Personal Page</title>
    <link>/post/</link>
    <description>Recent content in Posts on Chenhao&#39;s Personal Page</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>© This site was created with R BlogDown and HuGo by Chenhao Li.</copyright>
    <lastBuildDate>Sun, 01 Jan 2017 00:00:00 +0000</lastBuildDate><atom:link href="/post/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>圆角barplot</title>
      <link>/post/2022-05-31-round-corner-barplot/</link>
      <pubDate>Mon, 30 Aug 2021 00:00:00 +0000</pubDate>
      
      <guid>/post/2022-05-31-round-corner-barplot/</guid>
      <description>不同方法实现ggplot2圆角barplot</description>
    </item>
    
    <item>
      <title>让Single cell UMAP注释支棱起来</title>
      <link>/post/2021-08-12-singlecell-annotation-ggforce/</link>
      <pubDate>Mon, 30 Aug 2021 00:00:00 +0000</pubDate>
      
      <guid>/post/2021-08-12-singlecell-annotation-ggforce/</guid>
      <description>用ggforce注释Seurat UMAP</description>
    </item>
    
    <item>
      <title>Nextflow长命令segmentation fault的解决</title>
      <link>/post/2021-08-08-nextflow-trick/</link>
      <pubDate>Sun, 08 Aug 2021 00:00:00 +0000</pubDate>
      
      <guid>/post/2021-08-08-nextflow-trick/</guid>
      <description>在Mac上运行长命令导致segmentation fault</description>
    </item>
    
    <item>
      <title>nf-core流程使用</title>
      <link>/post/2021-05-20-nextflow-nfcore/</link>
      <pubDate>Thu, 20 May 2021 00:00:00 +0000</pubDate>
      
      <guid>/post/2021-05-20-nextflow-nfcore/</guid>
      <description>使用nf-core的atacseq流程进行ATAC-Seq分析</description>
    </item>
    
    <item>
      <title>Telegram bot基础使用</title>
      <link>/post/2021-05-11-telegrambot/</link>
      <pubDate>Tue, 11 May 2021 00:00:00 +0000</pubDate>
      
      <guid>/post/2021-05-11-telegrambot/</guid>
      <description>使用telegram bot api发送推送消息</description>
    </item>
    
    <item>
      <title>Kraken拓展工具KrakenTools</title>
      <link>/post/2020-08-22-krakentools/</link>
      <pubDate>Sat, 22 Aug 2020 00:00:00 +0000</pubDate>
      
      <guid>/post/2020-08-22-krakentools/</guid>
      <description>KrakenTools为后续处理Kraken的结果带来了极大便利，下面重点介绍kreport2mpa.py和extract_kraken_reads.py的使用。</description>
    </item>
    
    <item>
      <title>基于Nextflow的宏基因组有参分析-VI Nextflow tower本地配置</title>
      <link>/post/2019-10-29-nextflow-tower-deploy/</link>
      <pubDate>Tue, 29 Oct 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-10-29-nextflow-tower-deploy/</guid>
      <description>架设属于你自己的Nextflow tower</description>
    </item>
    
    <item>
      <title>基于Nextflow的宏基因组有参分析-V Nextflow tower</title>
      <link>/post/2019-10-25-nextflow-tower/</link>
      <pubDate>Fri, 25 Oct 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-10-25-nextflow-tower/</guid>
      <description>使用Nextflow tower实时监控流程的运行情况</description>
    </item>
    
    <item>
      <title>基于Nextflow的宏基因组有参分析-IV Kraken2&#43;Bracken</title>
      <link>/post/2019-10-17-nextflow-kraken/</link>
      <pubDate>Thu, 17 Oct 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-10-17-nextflow-kraken/</guid>
      <description>使用Kraken2+Bracken获取各级分类的相对丰度</description>
    </item>
    
    <item>
      <title>基于Nextflow的宏基因组有参分析-III 质控&#43;去宿主DNA</title>
      <link>/post/2019-10-01-nextflow-decont/</link>
      <pubDate>Tue, 01 Oct 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-10-01-nextflow-decont/</guid>
      <description>使用fastp, BWA, samtools完成宏基因组数据预处理</description>
    </item>
    
    <item>
      <title>基于Nextflow的宏基因组有参分析-II 主函数和输入输出</title>
      <link>/post/2019-09-29-nextflow-main/</link>
      <pubDate>Sun, 29 Sep 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-09-29-nextflow-main/</guid>
      <description>极简的Nextflow程序</description>
    </item>
    
    <item>
      <title>基于Nextflow的宏基因组有参分析-I 安装Nextflow</title>
      <link>/post/2019-09-27-nextflow-install/</link>
      <pubDate>Fri, 27 Sep 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-09-27-nextflow-install/</guid>
      <description>本系列介绍如何搭建基于Nextflow的宏基因组有参分析流程</description>
    </item>
    
    <item>
      <title>启动Conda环境时自动更改环境变量</title>
      <link>/post/2019-08-17-conda-activate/</link>
      <pubDate>Sat, 17 Aug 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-08-17-conda-activate/</guid>
      <description>Conda环境给我们安装软件带来了很多便利，我时常遇到需要在启用特定环境时加载环境变量的需求，本文介绍如何自动化这一过程</description>
    </item>
    
    <item>
      <title>Emacs远程连接R</title>
      <link>/post/2018-11-25-emacs-remote-r/</link>
      <pubDate>Sun, 25 Nov 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/2018-11-25-emacs-remote-r/</guid>
      <description>本地的R脚本，远程执行</description>
    </item>
    
    <item>
      <title>Frequently Googled Questions</title>
      <link>/post/2018-09-05-bioinfo-cheatsheet/</link>
      <pubDate>Wed, 05 Sep 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/2018-09-05-bioinfo-cheatsheet/</guid>
      <description>一些从来都需要google的东西</description>
    </item>
    
    <item>
      <title>一（三）文你读不懂PCA和PCoA</title>
      <link>/post/2018-04-39-r-pca_pcoa/</link>
      <pubDate>Mon, 30 Apr 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/2018-04-39-r-pca_pcoa/</guid>
      <description>今天看到金唯智公众号的推文《三文读懂PCA和PCoA》（《&lt;a href=&#34;http://blog.sina.com.cn/s/blog_a0d2a3c00102xl9e.html&#34;&gt;一&lt;/a&gt;》,《&lt;a href=&#34;http://blog.sina.com.cn/s/blog_a0d2a3c00102xl9f.html&#34;&gt;二&lt;/a&gt;》,《&lt;a href=&#34;http://blog.sina.com.cn/s/blog_a0d2a3c00102xl9h.html&#34;&gt;三&lt;/a&gt;》)。作者以平民化的语言，剔除数学术语，介绍了二者的区别，是很好的尝试，但是文中提出的很多关键性总结，都存在着明显的漏洞。</description>
    </item>
    
    <item>
      <title>Generating GraPhlAn-like microbiome visualization using ggtree and microbiomeViz</title>
      <link>/post/2018-04-20-r-microbiomeviz_example/</link>
      <pubDate>Fri, 20 Apr 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/2018-04-20-r-microbiomeviz_example/</guid>
      <description>Let&amp;rsquo;s try this for fun!</description>
    </item>
    
    <item>
      <title>Y叔的新包base2grob</title>
      <link>/post/2018-03-29-r-base2grob_igraph/</link>
      <pubDate>Thu, 29 Mar 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/2018-03-29-r-base2grob_igraph/</guid>
      <description>测试了一下Y叔的新包&lt;a href=&#34;https://cran.r-project.org/web/packages/base2grob/vignettes/base2grob.html&#34;&gt;base2grob&lt;/a&gt;。这个包提供了base2grob函数，可以把base plot转换成grob对象。对于我来说最大的方便就是可以把一些igraph画出的网络图通过cowplot和其他ggplot做出的图自由组合。</description>
    </item>
    
    <item>
      <title>microbiomeViz--斜体显示taxon name</title>
      <link>/post/2018-02-01-r-metagenomeviz-italictaxon/</link>
      <pubDate>Thu, 01 Feb 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/2018-02-01-r-metagenomeviz-italictaxon/</guid>
      <description>微生物种名属名经常需要*&lt;code&gt;斜体&lt;/code&gt;*表示，现在microbiomeViz添加了一个生成&lt;code&gt;expression&lt;/code&gt;的函数，可以直接将一个短语中的**一个**（个人认为很少会遇到画图时axis label涉及多个物种）指定名字变成斜体。</description>
    </item>
    
    <item>
      <title>microbiomeViz--人生第一个R包</title>
      <link>/post/2018-01-18-r-metagenomeviz/</link>
      <pubDate>Thu, 18 Jan 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/2018-01-18-r-metagenomeviz/</guid>
      <description>平日经常会分析shotgun宏基因组的数据，我们的&lt;a href=&#34;https://github.com/gis-rpd/pipelines/tree/devel/metagenomics/shotgun-metagenomics&#34;&gt;pipeline&lt;/a&gt;使用MetaPhlAn，Kraken等profiler。一直觉得&lt;a href=&#34;https://bitbucket.org/nsegata/graphlan/wiki/Home&#34;&gt;GraPhlAn&lt;/a&gt;的图很好看，在Y叔的指导下准备基于ggtree来用R实现它。</description>
    </item>
    
    <item>
      <title>成分之咒与ReBoot算法</title>
      <link>/post/2018-01-12-r-compositional/</link>
      <pubDate>Fri, 12 Jan 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/2018-01-12-r-compositional/</guid>
      <description>&lt;h1 id=&#34;写在前面&#34;&gt;写在前面&lt;/h1&gt;
&lt;p&gt;本文的大部分内容都来自我们之前的一篇综述文章&lt;a href=&#34;http://www.sciencedirect.com/science/article/pii/S1046202315300943?via%3Dihub&#34;&gt;Li et al, 2016&lt;/a&gt;。&lt;/p&gt;
&lt;h1 id=&#34;微生物组测序与成分数据&#34;&gt;微生物组测序与成分数据&lt;/h1&gt;
&lt;p&gt;微生物组测序数据的获得其实有很多抽样过程（Sampling process）存在，比如说，粪便微生物组其实是对肠道微生物的一次抽样，测序的过程也是对所有DNA分子的一次抽样。最后，我们得到的OTU表中的OTU read count与测序深度相关，很显然测序深度是一个技术上的干扰因子（confounder），所以我们要对OTU表进行标准化（Normalization）。最简单的标准化方法，就是用read count除以样本内所有OTU的read count之和，获得每个OTU的相对丰度（relative abundance）。这种只有相对丰度的数据（相加总数为常数1或100）被称为成分数据（Compositional data）。 你可能注意到，作为成分数据一种的微生物组的数据中缺乏一个重要的信息&amp;ndash;微生物总量（total abundance）。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ggplot扩展学习笔记--逐行解析Y叔的&#34;geom_ord_ellipse.R&#34;</title>
      <link>/post/2018-01-09-r-ordellipsecode/</link>
      <pubDate>Tue, 09 Jan 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/2018-01-09-r-ordellipsecode/</guid>
      <description>看到Y叔为&lt;a href=&#34;https://github.com/fawda123/ggord&#34;&gt;ggord&lt;/a&gt;做的添加置信椭圆的&lt;a href=&#34;https://github.com/GuangchuangYu/yyplot/blob/master/R/geom_ord_ellipse.R&#34;&gt;geom_ord_ellipse.R&lt;/a&gt;（用法见&lt;a href=&#34;http://lchblogs.netlify.com/post/2017-12-29-r-addconfellipse/&#34;&gt;上一篇文章&lt;/a&gt;），决定学习一点ggplot图形的语言，对于初学者最好的方法就是照葫芦画瓢，而Y叔的代码自然是最好的模板。我对Y叔的代码进行了逐行的分析，希望以后有需要可以套用。</description>
    </item>
    
    <item>
      <title>Useful commands for Docker</title>
      <link>/post/2017-12-31-bioinfo-docker_notes/</link>
      <pubDate>Sun, 31 Dec 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-12-31-bioinfo-docker_notes/</guid>
      <description>我的Docker初学笔记</description>
    </item>
    
    <item>
      <title>Add confidence ellipse to LDA ordination plot II</title>
      <link>/post/2017-12-29-r-addconfellipse/</link>
      <pubDate>Fri, 29 Dec 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-12-29-r-addconfellipse/</guid>
      <description>&lt;h2 id=&#34;为排序图添加置信范围曲线&#34;&gt;为排序图添加置信范围曲线&lt;/h2&gt;
&lt;p&gt;上一篇&lt;a href=&#34;http://lchblogs.netlify.com/post/2017-12-22-r-addconfellipselda/&#34;&gt;文章&lt;/a&gt;我们利用&lt;a href=&#34;https://github.com/fawda123/ggord&#34;&gt;ggord&lt;/a&gt;的源代码改写了一个为LDA排序图添加置信曲线的函数，现在&lt;a href=&#34;https://guangchuangyu.github.io/&#34;&gt;Y叔&lt;/a&gt;已经把它改写成了一个geom添加在了他的&lt;a href=&#34;https://github.com/GuangchuangYu/yyplot&#34;&gt;yyplot&lt;/a&gt;包中。y叔扩展了它的功能，现在支持ggord中的其他排序图（我没有进行全面的测试）。</description>
    </item>
    
    <item>
      <title>Add confidence ellipse to LDA ordination plot</title>
      <link>/post/2017-12-22-r-addconfellipselda/</link>
      <pubDate>Fri, 22 Dec 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-12-22-r-addconfellipselda/</guid>
      <description>Add confidence ellipse to LDA plots generated with ggord</description>
    </item>
    
    <item>
      <title>有了绝对定量就完了？</title>
      <link>/post/2017-11-18-r-absolute/</link>
      <pubDate>Tue, 28 Nov 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-11-18-r-absolute/</guid>
      <description>Jeroen Raes研究组上周在Nature发表&lt;a href=&#34;https://www.nature.com/articles/nature24460&#34;&gt;文章&lt;/a&gt;，使用Flow cytometry估算粪便中的微生物细胞数量，配合16S测序算出的相对丰度，估算出OTU的绝对数量（absolute abundance）。文章很多结论都印证了直接应用相对丰度进行分析时，我们所看到的很多现象是成分数据性质的假象（可以想象，由于相对丰度在每一个样本中相加为1或100，一个OTU相对丰度增加必将引起其他OTU相对丰度减少，所谓的compositional bias）。</description>
    </item>
    
    <item>
      <title>Generalized Lotka-Volterra model</title>
      <link>/post/2017-11-15-r-glv/</link>
      <pubDate>Wed, 15 Nov 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-11-15-r-glv/</guid>
      <description>Relative scaling for GLV models</description>
    </item>
    
    <item>
      <title>从curatedMetagenoimcData提取健康样本的微生物组</title>
      <link>/post/2017-11-07-r-curatedmetagenomicdata_retrievedata/</link>
      <pubDate>Tue, 07 Nov 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-11-07-r-curatedmetagenomicdata_retrievedata/</guid>
      <description>&lt;h2 id=&#34;简介&#34;&gt;简介&lt;/h2&gt;
&lt;p&gt;有人问我，这个curatedMetagenomicData有什么作用？对于我们这些research parasite(出处请见&lt;a href=&#34;http://www.nejm.org/doi/full/10.1056/NEJMe1516564#t=article&#34;&gt;NEJM社论&lt;/a&gt;)来说，这样庞大的数据集当然是用来挖信息或者是测试算法了：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;作为validation cohort来验证已发现的结论。如我们的&lt;a href=&#34;https://www.nature.com/articles/nmicrobiol2016106&#34;&gt;这篇文章&lt;/a&gt;都使用了2014年Oh et al发表于Nature的数据来佐证我们发现的Staphylococcus特异性突变。&lt;/li&gt;
&lt;li&gt;用来测试新方法，发现新的生物问题。如&lt;a href=&#34;http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1005614&#34;&gt;这篇文章&lt;/a&gt;中我们也用了Oh et al的数据来观测Malessezia在人体皮肤的分布。&lt;/li&gt;
&lt;li&gt;因为数据中有大量健康人的微生物组（不同研究中的control），我们也可以用它们补充我们的对照组（当然在机器学习中要注意数据不平衡问题）。
当然最基础的操作，就是要从数据库中提取数据。&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>A collection of useful tools (Keep updating)</title>
      <link>/post/2017-11-04-bioinfo-bioinforcollections/</link>
      <pubDate>Sat, 04 Nov 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-11-04-bioinfo-bioinforcollections/</guid>
      <description>A collection of bioinformatics resources</description>
    </item>
    
    <item>
      <title>桑基图（Sankey diagram）II</title>
      <link>/post/2017-11-02-r-sankeyplot2/</link>
      <pubDate>Thu, 02 Nov 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-11-02-r-sankeyplot2/</guid>
      <description>再次尝试桑基图</description>
    </item>
    
    <item>
      <title>超大宏基因组数据集CuratedMetagenomicData</title>
      <link>/post/2017-10-30-r-curatedmetagenomicdata/</link>
      <pubDate>Mon, 30 Oct 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-10-30-r-curatedmetagenomicdata/</guid>
      <description>&lt;h1 id=&#34;简介&#34;&gt;简介&lt;/h1&gt;
&lt;p&gt;CuratedMetagenomicData(&lt;a href=&#34;https://waldronlab.github.io/curatedMetagenomicData/&#34;&gt;https://waldronlab.github.io/curatedMetagenomicData/&lt;/a&gt;)的目标是用标准化的流程（MetaPhlan2、HUMAnN2）分析已发表的宏基因组数据并建立一个统一的数据集合。目前已经收录&lt;a href=&#34;https://waldronlab.github.io/curatedMetagenomicData/datasets-included/&#34;&gt;6000余个样本&lt;/a&gt;并在持续&lt;a href=&#34;https://waldronlab.github.io/curatedMetagenomicData/datasets-ongoing/&#34;&gt;扩建&lt;/a&gt;当中。样本涵盖糖尿病、肥胖症、IBD等多种疾病，涉及皮肤、口腔、粪便等多处样本。</description>
    </item>
    
    <item>
      <title>桑基图（Sankey diagram）</title>
      <link>/post/2017-10-29-r-sankeyplot/</link>
      <pubDate>Sun, 29 Oct 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-10-29-r-sankeyplot/</guid>
      <description>桑基图（Sankey diagram）是用于表示能量或信息流动的一种可视化方式，应用于微生物组数据，可以清晰展示各个taxonomy level之间物种相对丰度的流动。从Domain到Species，相邻两级之间分支的总宽度保持不变（能量守恒），如下图</description>
    </item>
    
  </channel>
</rss>
